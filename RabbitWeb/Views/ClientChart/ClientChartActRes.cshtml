@model RabbitWeb.Models.ClientChart
@{
    Layout = null;
}


<html>
<head>
    <script src="~/Scripts/Chart.min.js"></script>
    <script src="~/Scripts/jquery-3.6.0.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <style>
        #chart_container{
        width:1200px;
        height:400px;
        border:1px solid #ddd;
        padding:1px;
        border-radius:4px;      
        
        }
    </style>
</head>
<body>
    <div id="chart_container">
        <canvas id="line-chart" width="800" height="450"></canvas>
    </div>

 

    <script>
       
        var timeLabelArray =@Html.Raw(Json.Encode(Model.InsertMoments));
        var timeLabelInt = [];
        for (var i = 0; i < timeLabelArray.length; i++) {
            timeLabelArray[i] = timeLabelArray[i].substring(6, 19);
            timeLabelInt[i] = Math.floor(parseInt(timeLabelArray[i])/1000);
        }
        
        var endDate = Date.now();
        console.log(timeLabelInt);
        console.log(endDate);
        var degerler = [];
        for (var i = 0; i < 900; i++) {
            degerler[i] = 0;
        }
        
        var xEkseni = [];

        for (var i = 0; i < 900; i++) {
            xEkseni[i] = timeLabelInt[timeLabelInt.length - 1] - (900 - i);
        }
        console.log(xEkseni[0]);
        for (var i = 0; i < timeLabelInt.length; i++) {
            for (var j = 0; j < xEkseni.length; j++) {
                if (timeLabelInt[i] == xEkseni[j]) {
                    degerler[j] = 1;
                }
            }
        }
        var xEkseni2 = [];
        for (var i = 0; i < xEkseni.length; i++) {
            xEkseni2[i] = new Date(xEkseni[i] * 1000);
        }
       

    new Chart(document.getElementById("line-chart"), {

            type: 'line',
        data: {
            labels: xEkseni2,
            datasets: [{
                data: degerler,
                    label: "Mesaj",
                    borderColor: "#3e95cd",
                    fill: false
                },
                ]
            },
            options: {

                title: {
                    display: true,
                    text: 'Son 15 Dakikada her saniye için okunan mesajlar'
                }
            }
        });</script>



    @*<h1>@Model.ClientGuid</h1>
    <table>
        @foreach (var item in Model.InsertMoments)
        {
            <tr>
                <td>
                    @item
                </td>
            </tr>
        }
    </table>

    <h1>DÜŞTÜ</h1>*@
</body>
</html>